# Assignment 5

## 2 NumPy Warm-up

### 2.1

![](D:\Desktop\课程\专业课\SJTU-SE2324-计算机科学数学基础\Solution\2_1_1.png)

### 2.2

验证代码

```python
def gaussian(x, mean, variance):
    zeta = math.sqrt(2 * math.pi * variance)
    return 1. / zeta * np.exp(-np.power(x - mean, 2) / (2 * variance))


def verify(mean, variance):
    v, err = integrate.quad(gaussian, -10, 10, args=(mean, variance))
    print('mean = {0}, variance = {1}   :'.format(mean, variance), end='')
    # call numpy.isclose to check value
    print(np.isclose([v], [1.0]))
```

结果

```
mean = 0, variance = 1   :[ True]
mean = 0, variance = 2   :[ True]
mean = 0, variance = 0.2   :[ True]
mean = 2, variance = 1   :[ True]
```

## 3 Numerics and Linear Algebra

### 3_1

```
+----+-------------------------------------------------------------------+------------------------+
| N  |                        monomial coefficient                       |    residual L2 Norm    |
+----+-------------------------------------------------------------------+------------------------+
| 8  |  [ 1.00000000e+00 -1.92980788e-03 -9.64341068e-01 -2.55940537e-01 | 3.3306690738754696e-16 |
|    |   1.93414812e+00 -1.83752964e+00  7.29012818e-01 -1.03419883e-01] |                        |
| 16 |  [ 1.00000000e+00  2.66979000e-07 -1.00001351e+00  2.93916601e-04 | 1.7306664177452076e-15 |
|    |    9.96295668e-01  3.05534156e-02 -1.17587763e+00  7.32810435e-01 |                        |
|    |   -1.25243897e+00  5.13167697e+00 -9.56973019e+00  1.01178035e+01 |                        |
|    |  -6.70183430e+00  2.79541511e+00 -6.78605634e-01  7.36509945e-02] |                        |
+----+-------------------------------------------------------------------+------------------------+
```

![3_1_1](D:\Desktop\课程\专业课\SJTU-SE2324-计算机科学数学基础\Solution\3_1_1.png)

### 3.2

![](D:\Desktop\课程\专业课\SJTU-SE2324-计算机科学数学基础\Solution\3_2_1.png)

![3_2_2](D:\Desktop\课程\专业课\SJTU-SE2324-计算机科学数学基础\Solution\3_2_2.png)

从图中可以看到两个矩阵的 condition number 随 n 而指数级增长，比较直观的解释是随着 n 的增大，V 和 F 列向量之间的夹角越来越小，列与列之间越来越线性相关，因此即使 $\vec{f}$变化很小，却会导致系数变化幅度很大

### 3.3

```
+----+--------------+--------------+------------------------+--------------------+
| N  | isposdef(Av) | isposdef(AF) |        cond(V)         |      cond(F)       |
+----+--------------+--------------+------------------------+--------------------+
| 4  |     True     |     True     |   98.86773850722766    | 1.7320508075688772 |
| 6  |     True     |     True     |    4924.37105661106    | 9.171872237725903  |
| 8  |     True     |     True     |   267816.70090760005   | 68.55137085190168  |
| 10 |     True     |     True     |   15193229.677049411   | 562.7580822445406  |
| 12 |     True     |     True     |   883478686.1836076    | 4830.611029146824  |
| 14 |    False     |     True     |   52214922517.12616    | 42680.75493211507  |
| 16 |    False     |     True     |   3121662403201.779    | 385010.13412784704 |
| 18 |    False     |     True     |   188254229022756.3    | 3528111.5213114736 |
| 20 |    False     |     True     | 1.1722528631537054e+16 | 32732760.078300484 |
| 22 |    False     |    False     | 5.307811978221406e+17  | 306733651.4763673  |
| 24 |    False     |    False     | 1.6732639550599708e+18 | 2898148517.412925  |
| 26 |    False     |    False     | 4.809361466442202e+18  | 27573128629.336758 |
| 28 |    False     |    False     | 8.513196516565954e+18  | 263875678112.03745 |
| 30 |    False     |    False     | 2.1702851332170723e+19 | 2537780703596.8345 |
| 32 |    False     |    False     | 4.5302818866969103e+18 | 24653374108576.676 |
+----+--------------+--------------+------------------------+--------------------+
```

- 12 is the largest value of $N$ where  $A_V$ is positive definite, and the condition number of that $V$ is 883478686.1836076​
- 20 is the largest value of $N$ where  $A_F$ is positive definite, and the condition number of that $F$ is 32732760.078300484
- connection

### 3_4

```
+---+-------------------------------------------------------------------+------------------------+
| N |                                 V                                 |  residual L2 Norm(V)   |
+---+-------------------------------------------------------------------+------------------------+
| 8 |  [ 1.00000000e+00 -1.92980220e-03 -9.64341156e-01 -2.55940037e-01 | 4.2569029120714095e-11 |
|   |   1.93414674e+00 -1.83752766e+00  7.29011394e-01 -1.03419477e-01] |                        |
+---+-------------------------------------------------------------------+------------------------+


+---+--------------------------------------------------------------------------+------------------------+
| N |                                    F                                     |  residual L2 Norm(F)   |
+---+--------------------------------------------------------------------------+------------------------+
| 8 | [ 1.35488014 -0.04116264 -0.35430384  0.0015691   0.26057558  0.83058785 | 1.4895204919483639e-15 |
|   |                         -0.01057558 -0.08058785]                         |                        |
+---+--------------------------------------------------------------------------+------------------------+
```

LU 计算出的残差要更小

## 4 Least Squares Problems and QR

### 4_1

```
+----+---+---------------------------------------------------------------------+
| M  | N |                         monomial coefficient                        |
+----+---+---------------------------------------------------------------------+
| 16 | 4 |         [[ 1.00166564 -0.02698999 -1.01909544  0.54698731]]         |
| 16 | 8 |  [[ 1.00000188e+00 -1.07143503e-03 -9.75766185e-01 -2.00107692e-01  |
|    |   |    1.80128191e+00 -1.67195234e+00  6.25188414e-01 -7.75730913e-02]] |
+----+---+---------------------------------------------------------------------+
```

### 4_2

![4_2_1](D:\Desktop\课程\专业课\SJTU-SE2324-计算机科学数学基础\Solution\4_2_1.png)

